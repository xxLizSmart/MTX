import{c as M,r as d,j as e,x as Oe,R as Me,v as oe,d as Le,a as $e,e as _,m as le,B as C,Y as de,l as F,C as ue,Z as he}from"./index-83226fdf.js";import{H as De}from"./Helmet-d124395d.js";import{T as qe,a as Ue,b as $,c as D}from"./tabs-a4cebf4b.js";import{T as H,a as J,b as I,c as x,d as Y,e as j}from"./table-f272782e.js";import{D as q,a as ee,b as se,c as te,e as re,d as We,f as pe}from"./dialog-3f7e637c.js";import{I as U}from"./input-65b4c1e2.js";import{L as O}from"./label-00ac4211.js";import{P as me}from"./pen-square-9379f7cd.js";const fe=M("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Ve=M("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),He=M("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]),Je=M("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),Ye=M("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Ze=M("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);function Ke(s,r,{checkForDefaultPrevented:a=!0}={}){return function(n){if(s==null||s(n),a===!1||!n.defaultPrevented)return r==null?void 0:r(n)}}function xe(s,r){if(typeof s=="function")return s(r);s!=null&&(s.current=r)}function je(...s){return r=>{let a=!1;const u=s.map(n=>{const h=xe(n,r);return!a&&typeof h=="function"&&(a=!0),h});if(a)return()=>{for(let n=0;n<u.length;n++){const h=u[n];typeof h=="function"?h():xe(s[n],null)}}}}function we(...s){return d.useCallback(je(...s),s)}function Xe(s,r=[]){let a=[];function u(h,c){const i=d.createContext(c),m=a.length;a=[...a,c];const w=g=>{var E;const{scope:S,children:k,...y}=g,N=((E=S==null?void 0:S[s])==null?void 0:E[m])||i,R=d.useMemo(()=>y,Object.values(y));return e.jsx(N.Provider,{value:R,children:k})};w.displayName=h+"Provider";function o(g,S){var N;const k=((N=S==null?void 0:S[s])==null?void 0:N[m])||i,y=d.useContext(k);if(y)return y;if(c!==void 0)return c;throw new Error(`\`${g}\` must be used within \`${h}\``)}return[w,o]}const n=()=>{const h=a.map(c=>d.createContext(c));return function(i){const m=(i==null?void 0:i[s])||h;return d.useMemo(()=>({[`__scope${s}`]:{...i,[s]:m}}),[i,m])}};return n.scopeName=s,[u,Ge(n,...r)]}function Ge(...s){const r=s[0];if(s.length===1)return r;const a=()=>{const u=s.map(n=>({useScope:n(),scopeName:n.scopeName}));return function(h){const c=u.reduce((i,{useScope:m,scopeName:w})=>{const g=m(h)[`__scope${w}`];return{...i,...g}},{});return d.useMemo(()=>({[`__scope${r.scopeName}`]:c}),[c])}};return a.scopeName=r.scopeName,a}var ge=globalThis!=null&&globalThis.document?d.useLayoutEffect:()=>{},Qe=Oe[" useInsertionEffect ".trim().toString()]||ge;function es({prop:s,defaultProp:r,onChange:a=()=>{},caller:u}){const[n,h,c]=ss({defaultProp:r,onChange:a}),i=s!==void 0,m=i?s:n;{const o=d.useRef(s!==void 0);d.useEffect(()=>{const g=o.current;g!==i&&console.warn(`${u} is changing from ${g?"controlled":"uncontrolled"} to ${i?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),o.current=i},[i,u])}const w=d.useCallback(o=>{var g;if(i){const S=ts(o)?o(s):o;S!==s&&((g=c.current)==null||g.call(c,S))}else h(o)},[i,s,h,c]);return[m,w]}function ss({defaultProp:s,onChange:r}){const[a,u]=d.useState(s),n=d.useRef(a),h=d.useRef(r);return Qe(()=>{h.current=r},[r]),d.useEffect(()=>{var c;n.current!==a&&((c=h.current)==null||c.call(h,a),n.current=a)},[a,n]),[a,u,h]}function ts(s){return typeof s=="function"}function rs(s){const r=d.useRef({value:s,previous:s});return d.useMemo(()=>(r.current.value!==s&&(r.current.previous=r.current.value,r.current.value=s),r.current.previous),[s])}function ns(s){const[r,a]=d.useState(void 0);return ge(()=>{if(s){a({width:s.offsetWidth,height:s.offsetHeight});const u=new ResizeObserver(n=>{if(!Array.isArray(n)||!n.length)return;const h=n[0];let c,i;if("borderBoxSize"in h){const m=h.borderBoxSize,w=Array.isArray(m)?m[0]:m;c=w.inlineSize,i=w.blockSize}else c=s.offsetWidth,i=s.offsetHeight;a({width:c,height:i})});return u.observe(s,{box:"border-box"}),()=>u.unobserve(s)}else a(void 0)},[s]),r}function as(s){const r=is(s),a=d.forwardRef((u,n)=>{const{children:h,...c}=u,i=d.Children.toArray(h),m=i.find(os);if(m){const w=m.props.children,o=i.map(g=>g===m?d.Children.count(w)>1?d.Children.only(null):d.isValidElement(w)?w.props.children:null:g);return e.jsx(r,{...c,ref:n,children:d.isValidElement(w)?d.cloneElement(w,void 0,o):null})}return e.jsx(r,{...c,ref:n,children:h})});return a.displayName=`${s}.Slot`,a}function is(s){const r=d.forwardRef((a,u)=>{const{children:n,...h}=a;if(d.isValidElement(n)){const c=ds(n),i=ls(h,n.props);return n.type!==d.Fragment&&(i.ref=u?je(u,c):c),d.cloneElement(n,i)}return d.Children.count(n)>1?d.Children.only(null):null});return r.displayName=`${s}.SlotClone`,r}var cs=Symbol("radix.slottable");function os(s){return d.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===cs}function ls(s,r){const a={...r};for(const u in r){const n=s[u],h=r[u];/^on[A-Z]/.test(u)?n&&h?a[u]=(...i)=>{const m=h(...i);return n(...i),m}:n&&(a[u]=n):u==="style"?a[u]={...n,...h}:u==="className"&&(a[u]=[n,h].filter(Boolean).join(" "))}return{...s,...a}}function ds(s){var u,n;let r=(u=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:u.get,a=r&&"isReactWarning"in r&&r.isReactWarning;return a?s.ref:(r=(n=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:n.get,a=r&&"isReactWarning"in r&&r.isReactWarning,a?s.props.ref:s.props.ref||s.ref)}var us=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],ve=us.reduce((s,r)=>{const a=as(`Primitive.${r}`),u=d.forwardRef((n,h)=>{const{asChild:c,...i}=n,m=c?a:r;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(m,{...i,ref:h})});return u.displayName=`Primitive.${r}`,{...s,[r]:u}},{}),Z="Switch",[hs,Cs]=Xe(Z),[ps,ms]=hs(Z),ye=d.forwardRef((s,r)=>{const{__scopeSwitch:a,name:u,checked:n,defaultChecked:h,required:c,disabled:i,value:m="on",onCheckedChange:w,form:o,...g}=s,[S,k]=d.useState(null),y=we(r,z=>k(z)),N=d.useRef(!1),R=S?o||!!S.closest("form"):!0,[E,A]=es({prop:n,defaultProp:h??!1,onChange:w,caller:Z});return e.jsxs(ps,{scope:a,checked:E,disabled:i,children:[e.jsx(ve.button,{type:"button",role:"switch","aria-checked":E,"aria-required":c,"data-state":Ce(E),"data-disabled":i?"":void 0,disabled:i,value:m,...g,ref:y,onClick:Ke(s.onClick,z=>{A(K=>!K),R&&(N.current=z.isPropagationStopped(),N.current||z.stopPropagation())})}),R&&e.jsx(_e,{control:S,bubbles:!N.current,name:u,value:m,checked:E,required:c,disabled:i,form:o,style:{transform:"translateX(-100%)"}})]})});ye.displayName=Z;var be="SwitchThumb",Se=d.forwardRef((s,r)=>{const{__scopeSwitch:a,...u}=s,n=ms(be,a);return e.jsx(ve.span,{"data-state":Ce(n.checked),"data-disabled":n.disabled?"":void 0,...u,ref:r})});Se.displayName=be;var fs="SwitchBubbleInput",_e=d.forwardRef(({__scopeSwitch:s,control:r,checked:a,bubbles:u=!0,...n},h)=>{const c=d.useRef(null),i=we(c,h),m=rs(a),w=ns(r);return d.useEffect(()=>{const o=c.current;if(!o)return;const g=window.HTMLInputElement.prototype,k=Object.getOwnPropertyDescriptor(g,"checked").set;if(m!==a&&k){const y=new Event("click",{bubbles:u});k.call(o,a),o.dispatchEvent(y)}},[m,a,u]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a,...n,tabIndex:-1,ref:i,style:{...n.style,...w,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});_e.displayName=fs;function Ce(s){return s?"checked":"unchecked"}var Ne=ye,xs=Se;const ke=Me.forwardRef(({className:s,...r},a)=>e.jsx(Ne,{className:oe("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...r,ref:a,children:e.jsx(xs,{className:oe("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));ke.displayName=Ne.displayName;const Ns=()=>{const{toast:s}=Le(),{session:r}=$e(),[a,u]=d.useState("users"),[n,h]=d.useState({users:[],deposits:[],withdrawals:[],kyc:[],tradeSettings:[]}),[c,i]=d.useState(!1),[m,w]=d.useState(null),[o,g]=d.useState(null),[S,k]=d.useState([]),[y,N]=d.useState(null),[R,E]=d.useState(""),A=d.useCallback(async()=>{if(r){i(!0);try{const{data:t,error:p}=await _.from("profiles").select("*");if(p)throw new Error(`Users Fetch: ${p.message}`);const l=t||[],v=new Map(l.map(V=>[V.id,V])),{data:b,error:f}=await _.from("deposits").select("*");if(f)throw new Error(`Deposits Fetch: ${f.message}`);const{data:T,error:B}=await _.from("withdrawals").select("*");if(B)throw new Error(`Withdrawals Fetch: ${B.message}`);const{data:P,error:ae}=await _.from("profiles").select("*").in("kyc_status",["pending","approved","rejected"]);if(ae)throw new Error(`KYC Fetch: ${ae.message}`);const{data:Be,error:Q}=await _.from("trade_settings").select("*").order("duration");if(Q&&Q.code!=="42P01")throw new Error(`Settings Fetch: ${Q.message}`);const ie=V=>V.map(ce=>({...ce,users:v.get(ce.user_id)}));h({users:l,deposits:ie(b||[]),withdrawals:ie(T||[]),kyc:P||[],tradeSettings:Be||[]})}catch(t){console.error(t),s({variant:"destructive",title:"Failed to fetch data",description:t.message})}i(!1)}},[s,r]);d.useEffect(()=>{r&&A()},[A,r]);const z=async(t,p,l)=>{const v="https://tufxtnrmlwzgnufktelo.supabase.co",{data:{session:b}}=await _.auth.getSession(),f=await fetch(`${v}/functions/v1/admin-approve`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${b.access_token}`,apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR1Znh0bnJtbHd6Z251Zmt0ZWxvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA4NzMzMjYsImV4cCI6MjA4NjQ0OTMyNn0.3qkEIWXFoW0HKF2wX9Y5aPWJdVGuH6MnVrYrq_wm_ws"},body:JSON.stringify({action:l,table:t,id:p})}),T=await f.json();if(!f.ok||!T.success)throw new Error(T.error||"Edge function failed");return T},K=async(t,p,l)=>{const v=`${l}_${t==="deposits"?"deposit":"withdrawal"}`,b=t==="deposits"?"p_deposit_id":"p_withdrawal_id",{data:f,error:T}=await _.rpc(v,{[b]:p,p_admin_id:r.user.id});if(T)throw T;if(f&&!f.success)throw new Error(f.error);return f},Ee=async(t,p,l,v)=>{const b={status:l,reviewed_by:r.user.id,reviewed_at:new Date().toISOString()},{error:f}=await _.from(t).update(b).eq("id",p);if(f)throw f;if((t==="deposits"&&l==="approved"||t==="withdrawals"&&l==="rejected")&&v.userId){const{data:B}=await _.from("user_assets").select("id, amount").eq("user_id",v.userId).eq("symbol",v.currency).maybeSingle();if(B){const{error:P}=await _.from("user_assets").update({amount:parseFloat(B.amount)+parseFloat(v.amount)}).eq("id",B.id);if(P)throw P}else{const{error:P}=await _.from("user_assets").insert({user_id:v.userId,symbol:v.currency,amount:parseFloat(v.amount)});if(P)throw P}}},W=async(t,p,l,v={})=>{if(r){i(!0);try{if(t==="profiles"){const{error:f}=await _.from(t).update({kyc_status:l}).eq("id",p);if(f)throw f;s({title:"Success",description:`Status updated to ${l}`}),await A(),i(!1);return}const b=l==="approved"?"approve":"reject";try{await z(t,p,b)}catch{try{await K(t,p,b)}catch{await Ee(t,p,l,v)}}s({title:"Success",description:`Status updated to ${l}`}),await A()}catch(b){s({variant:"destructive",title:"Update failed",description:b.message})}i(!1)}},X=async t=>{g(t),i(!0);const{data:p,error:l}=await _.from("user_assets").select("*").eq("user_id",t.id);l?(s({variant:"destructive",title:"Failed to fetch balances",description:l.message}),k([])):k(p),i(!1)},Te=async(t,p)=>{const{error:l}=await _.from("user_assets").update({amount:p}).eq("id",t);l?s({variant:"destructive",title:"Update failed",description:l.message}):(s({title:"Success",description:"Balance updated"}),X(o))},Re=async()=>{if(!o||!R.trim())return;const t=R.trim().toUpperCase(),{error:p}=await _.from("user_assets").insert({user_id:o.id,symbol:t,amount:0});p?s({variant:"destructive",title:"Add failed",description:p.message}):(s({title:"Success",description:`${t} balance added`}),E(""),X(o))},Ae=async()=>{if(!y)return;i(!0);const{id:t,...p}=y,{error:l}=await _.from("trade_settings").update(p).eq("id",t);l?s({variant:"destructive",title:"Update failed",description:l.message}):(s({title:"Success",description:"Trade setting updated"}),N(null),await A()),i(!1)},G=async(t,p)=>{i(!0);const{data:l,error:v}=await _.from("profiles").update({trade_override_status:p}).eq("id",t).select().single();v?s({variant:"destructive",title:"Override failed",description:v.message}):(s({title:"Success",description:`Trade override for user set to: ${p||"OFF"}`}),g(l),h(b=>({...b,users:b.users.map(f=>f.id===t?l:f)}))),i(!1)},Fe=async(t,p)=>{i(!0);const{data:l,error:v}=await _.from("profiles").update({is_admin:!p}).eq("id",t).select().single();v?s({variant:"destructive",title:"Update failed",description:v.message}):(s({title:"Success",description:"User admin status updated"}),g(l),h(b=>({...b,users:b.users.map(f=>f.id===t?l:f)}))),i(!1)},L=t=>{switch(t==null?void 0:t.toLowerCase()){case"approved":case"win":case"completed":return e.jsx(F,{variant:"success",className:"bg-green-500",children:t});case"pending":return e.jsx(F,{variant:"secondary",children:t});case"rejected":case"loss":return e.jsx(F,{variant:"destructive",children:t});default:return e.jsx(F,{children:t||"N/A"})}},Ie=()=>e.jsxs(H,{children:[e.jsx(J,{children:e.jsxs(I,{children:[e.jsx(x,{children:"Name"}),e.jsx(x,{children:"Email"}),e.jsx(x,{children:"Role"}),e.jsx(x,{children:"KYC"}),e.jsx(x,{children:"Trade Override"}),e.jsx(x,{children:"Joined"}),e.jsx(x,{children:"Actions"})]})}),e.jsx(Y,{children:n.users.map(t=>e.jsxs(I,{children:[e.jsxs(j,{children:[t.first_name||"N/A"," ",t.last_name||""]}),e.jsx(j,{children:t.email}),e.jsx(j,{children:t.is_admin?e.jsx(F,{className:"bg-purple-600",children:"Admin"}):e.jsx(F,{variant:"outline",children:"User"})}),e.jsx(j,{children:L(t.kyc_status)}),e.jsx(j,{children:t.trade_override_status?L(t.trade_override_status):e.jsx(F,{variant:"outline",children:"Off"})}),e.jsx(j,{children:new Date(t.created_at).toLocaleDateString()}),e.jsx(j,{children:e.jsx(C,{variant:"ghost",size:"icon",onClick:()=>X(t),children:e.jsx(me,{className:"h-4 w-4"})})})]},t.id))})]}),ne=(t,p)=>e.jsxs(H,{children:[e.jsx(J,{children:e.jsxs(I,{children:[e.jsx(x,{children:"User"}),e.jsx(x,{children:"Email"}),e.jsx(x,{children:"Amount"}),e.jsx(x,{children:"Status"}),p==="deposits"&&e.jsx(x,{children:"Proof"}),p==="withdrawals"&&e.jsx(x,{children:"Address"}),e.jsx(x,{children:"Date"}),e.jsx(x,{children:"Actions"})]})}),e.jsx(Y,{children:t.map(l=>{var v,b,f;return e.jsxs(I,{children:[e.jsxs(j,{children:[((v=l.users)==null?void 0:v.first_name)||"N/A"," ",((b=l.users)==null?void 0:b.last_name)||""]}),e.jsx(j,{children:(f=l.users)==null?void 0:f.email}),e.jsxs(j,{children:[l.amount," ",l.currency]}),e.jsx(j,{children:L(l.status)}),p==="deposits"&&e.jsx(j,{children:l.proof_url&&e.jsx(q,{children:e.jsx(pe,{asChild:!0,children:e.jsx(C,{variant:"outline",size:"icon",onClick:()=>w(l.proof_url),children:e.jsx(fe,{className:"h-4 w-4"})})})})}),p==="withdrawals"&&e.jsx(j,{className:"truncate max-w-[150px]",children:l.wallet_address}),e.jsx(j,{children:new Date(l.created_at).toLocaleString()}),e.jsx(j,{className:"space-x-2",children:l.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(C,{size:"icon",variant:"ghost",className:"text-green-500",onClick:()=>W(p,l.id,"approved",{userId:l.user_id,amount:l.amount,currency:l.currency}),children:e.jsx(ue,{className:"h-4 w-4"})}),e.jsx(C,{size:"icon",variant:"ghost",className:"text-red-500",onClick:()=>W(p,l.id,"rejected",{userId:l.user_id,amount:l.amount,currency:l.currency}),children:e.jsx(he,{className:"h-4 w-4"})})]})})]},l.id)})})]}),Pe=()=>e.jsxs(H,{children:[e.jsx(J,{children:e.jsxs(I,{children:[e.jsx(x,{children:"Name"}),e.jsx(x,{children:"Email"}),e.jsx(x,{children:"Country"}),e.jsx(x,{children:"Status"}),e.jsx(x,{children:"Document"}),e.jsx(x,{children:"Actions"})]})}),e.jsx(Y,{children:n.kyc.map(t=>e.jsxs(I,{children:[e.jsxs(j,{children:[t.first_name," ",t.last_name]}),e.jsx(j,{children:t.email||"N/A"}),e.jsx(j,{children:t.country||"N/A"}),e.jsx(j,{children:L(t.kyc_status)}),e.jsx(j,{children:t.id_document_url&&e.jsx(q,{children:e.jsx(pe,{asChild:!0,children:e.jsx(C,{variant:"outline",size:"icon",onClick:()=>w(t.id_document_url),children:e.jsx(fe,{className:"h-4 w-4"})})})})}),e.jsx(j,{className:"space-x-2",children:t.kyc_status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(C,{size:"icon",variant:"ghost",className:"text-green-500",onClick:()=>W("profiles",t.id,"approved",{kyc:!0}),children:e.jsx(ue,{className:"h-4 w-4"})}),e.jsx(C,{size:"icon",variant:"ghost",className:"text-red-500",onClick:()=>W("profiles",t.id,"rejected",{kyc:!0}),children:e.jsx(he,{className:"h-4 w-4"})})]})})]},t.id))})]}),ze=()=>e.jsxs(H,{children:[e.jsx(J,{children:e.jsxs(I,{children:[e.jsx(x,{children:"Duration (s)"}),e.jsx(x,{children:"Win Rate (%)"}),e.jsx(x,{children:"Loss Rate (%)"}),e.jsx(x,{children:"Min Capital"}),e.jsx(x,{children:"Actions"})]})}),e.jsx(Y,{children:n.tradeSettings.map(t=>e.jsxs(I,{children:[e.jsx(j,{children:t.duration}),e.jsx(j,{children:(t.win_rate*100).toFixed(2)}),e.jsx(j,{children:(t.loss_rate*100).toFixed(2)}),e.jsx(j,{children:t.min_capital}),e.jsx(j,{children:e.jsx(C,{size:"icon",variant:"ghost",onClick:()=>N(t),children:e.jsx(me,{className:"h-4 w-4"})})})]},t.id))})]});return e.jsxs(e.Fragment,{children:[e.jsx(De,{children:e.jsx("title",{children:"Admin Panel - MetaTradeX"})}),e.jsxs("div",{className:"container mx-auto p-4 sm:p-6 lg:p-8",children:[e.jsxs(le.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Admin Panel"}),e.jsx(C,{onClick:A,disabled:c,variant:"outline",size:"icon",children:e.jsx(Je,{className:`h-4 w-4 ${c?"animate-spin":""}`})})]}),e.jsxs(qe,{value:a,onValueChange:u,className:"w-full",children:[e.jsxs(Ue,{className:"grid w-full grid-cols-2 sm:grid-cols-3 md:grid-cols-5 mb-4",children:[e.jsxs($,{value:"users",children:[e.jsx(Ze,{className:"w-4 h-4 mr-2"}),"Users"]}),e.jsxs($,{value:"deposits",children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),"Deposits"]}),e.jsxs($,{value:"withdrawals",children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),"Withdrawals"]}),e.jsxs($,{value:"kyc",children:[e.jsx(Ve,{className:"w-4 h-4 mr-2"}),"KYC"]}),e.jsxs($,{value:"settings",children:[e.jsx(Ye,{className:"w-4 h-4 mr-2"}),"Trading"]})]}),e.jsxs(le.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},transition:{duration:.3},className:"overflow-x-auto",children:[e.jsx(D,{value:"users",children:c?e.jsx("p",{children:"Loading..."}):Ie()}),e.jsx(D,{value:"deposits",children:c?e.jsx("p",{children:"Loading..."}):ne(n.deposits,"deposits")}),e.jsx(D,{value:"withdrawals",children:c?e.jsx("p",{children:"Loading..."}):ne(n.withdrawals,"withdrawals")}),e.jsx(D,{value:"kyc",children:c?e.jsx("p",{children:"Loading..."}):Pe()}),e.jsx(D,{value:"settings",children:c?e.jsx("p",{children:"Loading..."}):ze()})]},a)]})]}),e.jsx(q,{open:!!m,onOpenChange:()=>w(null),children:e.jsxs(ee,{className:"max-w-3xl",children:[e.jsx(se,{children:e.jsx(te,{children:"Document Viewer"})}),m&&e.jsx("img",{src:m,alt:"KYC or Deposit Proof",className:"max-w-full h-auto rounded-md"}),e.jsxs(re,{children:[e.jsx(C,{onClick:()=>window.open(m,"_blank"),children:"Download"}),e.jsx(C,{onClick:()=>w(null),children:"Close"})]})]})}),e.jsx(q,{open:!!o,onOpenChange:()=>g(null),children:e.jsxs(ee,{className:"max-w-2xl",children:[e.jsxs(se,{children:[e.jsxs(te,{children:["Edit User: ",o==null?void 0:o.first_name," ",o==null?void 0:o.last_name]}),e.jsx(We,{children:"Manage user balances and trade outcomes."})]}),e.jsxs("div",{className:"py-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-md bg-muted/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(He,{className:"h-4 w-4 text-purple-600"}),e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(O,{className:"text-base",children:"Admin Status"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Grant full administrative access to this user."})]})]}),e.jsx(ke,{checked:o==null?void 0:o.is_admin,onCheckedChange:()=>Fe(o.id,o.is_admin),disabled:c})]}),e.jsx("h3",{className:"font-semibold",children:"Balances"}),c?e.jsx("p",{children:"Loading balances..."}):S.map(t=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"w-20",children:t.symbol}),e.jsx(U,{type:"number",defaultValue:t.amount,onBlur:p=>Te(t.id,p.target.value)})]},t.id)),e.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[e.jsx(U,{placeholder:"Symbol (e.g. BTC)",value:R,onChange:t=>E(t.target.value),className:"w-40"}),e.jsx(C,{variant:"outline",size:"sm",onClick:Re,disabled:!R.trim(),children:"Add Balance"})]}),e.jsx("h3",{className:"font-semibold pt-4",children:"Trade Control"}),e.jsxs("div",{className:"p-3 rounded-md border bg-background/50 space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(O,{children:"Current Status:"}),o!=null&&o.trade_override_status?L(o.trade_override_status):e.jsx(F,{variant:"outline",children:"OFF"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2",children:[e.jsx(C,{variant:"success",className:"bg-green-500",onClick:()=>G(o.id,"win"),disabled:c||(o==null?void 0:o.trade_override_status)==="win",children:"Switch Win ON"}),e.jsx(C,{variant:"destructive",onClick:()=>G(o.id,"loss"),disabled:c||(o==null?void 0:o.trade_override_status)==="loss",children:"Switch Loss ON"}),e.jsx(C,{variant:"outline",onClick:()=>G(o.id,null),disabled:c||!(o!=null&&o.trade_override_status),children:"Switch OFF"})]})]})]}),e.jsx(re,{children:e.jsx(C,{onClick:()=>g(null),children:"Close"})})]})}),e.jsx(q,{open:!!y,onOpenChange:()=>N(null),children:e.jsxs(ee,{children:[e.jsx(se,{children:e.jsxs(te,{children:["Edit Setting for ",y==null?void 0:y.duration,"s"]})}),y&&e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(O,{htmlFor:"win_rate",className:"text-right",children:"Win Rate (%)"}),e.jsx(U,{id:"win_rate",type:"number",value:y.win_rate*100,onChange:t=>N({...y,win_rate:parseFloat(t.target.value)/100}),className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(O,{htmlFor:"loss_rate",className:"text-right",children:"Loss Rate (%)"}),e.jsx(U,{id:"loss_rate",type:"number",value:y.loss_rate*100,onChange:t=>N({...y,loss_rate:parseFloat(t.target.value)/100}),className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(O,{htmlFor:"min_capital",className:"text-right",children:"Min Capital"}),e.jsx(U,{id:"min_capital",type:"number",value:y.min_capital,onChange:t=>N({...y,min_capital:parseFloat(t.target.value)}),className:"col-span-3"})]})]}),e.jsx(re,{children:e.jsx(C,{onClick:Ae,disabled:c,children:c?"Saving...":"Save Changes"})})]})})]})};export{Ns as default};
