import{c as w,u as S,d as D,a as E,r as n,j as e,B as U,e as g}from"./index-a74a7c1a.js";import{H as k}from"./Helmet-9de942c9.js";import{I as i}from"./input-e2d4a862.js";import{L as r}from"./label-7491db19.js";import{C as q,a as L,b as Y,d as _,c as I}from"./card-1049f9d3.js";const K=w("UploadCloud",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m16 16-4-4-4 4",key:"119tzi"}]]),z=()=>{const{t:y}=S(),{toast:o}=D(),{user:c}=E(),[s,m]=n.useState({firstName:"",middleName:"",lastName:"",country:"",phoneNumber:"",address:""}),[l,u]=n.useState(null),[h,p]=n.useState(!1),t=a=>{m({...s,[a.target.id]:a.target.value})},v=a=>{a.target.files&&a.target.files.length>0&&u(a.target.files[0])},b=async a=>{a.preventDefault(),p(!0);try{let d="";if(l){const C=l.name.split(".").pop(),f=`kyc-documents/${`${c.id}-${Math.random()}.${C}`}`;let N=g.storage.from("documents");const{error:j}=await N.upload(f,l);if(j)throw new Error(`Upload failed: ${j.message}`);const{data:F}=N.getPublicUrl(f);d=F.publicUrl}const{error:x}=await g.from("profiles").update({first_name:s.firstName,middle_name:s.middleName,last_name:s.lastName,country:s.country,phone:s.phoneNumber,address:s.address,id_document_url:d,kyc_status:"pending"}).eq("id",c.id);if(x)throw x;o({title:"Success!",description:"Your KYC information has been submitted for review."}),m({firstName:"",middleName:"",lastName:"",country:"",phoneNumber:"",address:""}),u(null)}catch(d){console.error("KYC Submission Error:",d),o({variant:"destructive",title:"Error",description:d.message||"Failed to submit KYC"})}finally{p(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(k,{children:e.jsxs("title",{children:[y("kyc")," - MetaTradeX"]})}),e.jsx("div",{className:"container mx-auto p-4 sm:p-6 lg:p-8 flex justify-center",children:e.jsxs(q,{className:"w-full max-w-2xl",children:[e.jsxs(L,{children:[e.jsx(Y,{className:"text-3xl font-bold",children:"KYC Verification"}),e.jsx(_,{children:"Please fill in your details accurately for verification."})]}),e.jsx(I,{children:e.jsxs("form",{onSubmit:b,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"firstName",children:"First Name"}),e.jsx(i,{id:"firstName",value:s.firstName,onChange:t,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"lastName",children:"Last Name"}),e.jsx(i,{id:"lastName",value:s.lastName,onChange:t,required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"middleName",children:"Middle Name (Optional)"}),e.jsx(i,{id:"middleName",value:s.middleName,onChange:t})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"country",children:"Country"}),e.jsx(i,{id:"country",value:s.country,onChange:t,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"phoneNumber",children:"Phone Number"}),e.jsx(i,{id:"phoneNumber",type:"tel",value:s.phoneNumber,onChange:t,required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"address",children:"Full Address"}),e.jsx(i,{id:"address",value:s.address,onChange:t,required:!0})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"id-file",children:"Upload ID Document"}),e.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-dashed rounded-md",children:e.jsxs("div",{className:"space-y-1 text-center",children:[e.jsx(K,{className:"mx-auto h-12 w-12 text-muted-foreground"}),e.jsxs("div",{className:"flex text-sm text-muted-foreground",children:[e.jsxs(r,{htmlFor:"id-file-upload",className:"relative cursor-pointer rounded-md font-medium text-primary hover:text-primary/80",children:[e.jsx("input",{id:"id-file-upload",type:"file",className:"sr-only",onChange:v,required:!0}),e.jsx("span",{children:"Upload a file"})]}),e.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),l?e.jsx("p",{className:"text-xs",children:l.name}):e.jsx("p",{className:"text-xs",children:"Passport, Driver's License, etc."})]})})]}),e.jsx(U,{type:"submit",className:"w-full !mt-8",size:"lg",disabled:h,children:h?"Submitting...":"Submit for Verification"})]})})]})})]})};export{z as default};
