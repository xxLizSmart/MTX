import{c as $,r as d,j as e,x as $e,R as De,v as oe,d as Le,a as Oe,e as _,m as le,B as C,Y as de,l as A,C as ue,Z as he}from"./index-bc28f289.js";import{H as Me}from"./Helmet-2bae2f2d.js";import{T as Ie,a as qe,b as L,c as O}from"./tabs-36d75991.js";import{T as K,a as Y,b as F,c as m,d as X,e as x}from"./table-90bdd3a0.js";import{D as M,a as ee,b as se,c as te,e as re,d as Ue,f as pe}from"./dialog-37e5da2f.js";import{I}from"./input-e21fa800.js";import{L as z}from"./label-c69623d7.js";import{P as fe}from"./pen-square-381e7f86.js";const me=$("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),We=$("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),Ve=$("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]),He=$("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),Ke=$("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Ye=$("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);function Xe(s,r,{checkForDefaultPrevented:n=!0}={}){return function(a){if(s==null||s(a),n===!1||!a.defaultPrevented)return r==null?void 0:r(a)}}function xe(s,r){if(typeof s=="function")return s(r);s!=null&&(s.current=r)}function je(...s){return r=>{let n=!1;const u=s.map(a=>{const h=xe(a,r);return!n&&typeof h=="function"&&(n=!0),h});if(n)return()=>{for(let a=0;a<u.length;a++){const h=u[a];typeof h=="function"?h():xe(s[a],null)}}}}function we(...s){return d.useCallback(je(...s),s)}function Ze(s,r=[]){let n=[];function u(h,o){const i=d.createContext(o),f=n.length;n=[...n,o];const w=v=>{var E;const{scope:b,children:k,...g}=v,N=((E=b==null?void 0:b[s])==null?void 0:E[f])||i,R=d.useMemo(()=>g,Object.values(g));return e.jsx(N.Provider,{value:R,children:k})};w.displayName=h+"Provider";function l(v,b){var N;const k=((N=b==null?void 0:b[s])==null?void 0:N[f])||i,g=d.useContext(k);if(g)return g;if(o!==void 0)return o;throw new Error(`\`${v}\` must be used within \`${h}\``)}return[w,l]}const a=()=>{const h=n.map(o=>d.createContext(o));return function(i){const f=(i==null?void 0:i[s])||h;return d.useMemo(()=>({[`__scope${s}`]:{...i,[s]:f}}),[i,f])}};return a.scopeName=s,[u,Ge(a,...r)]}function Ge(...s){const r=s[0];if(s.length===1)return r;const n=()=>{const u=s.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(h){const o=u.reduce((i,{useScope:f,scopeName:w})=>{const v=f(h)[`__scope${w}`];return{...i,...v}},{});return d.useMemo(()=>({[`__scope${r.scopeName}`]:o}),[o])}};return n.scopeName=r.scopeName,n}var ve=globalThis!=null&&globalThis.document?d.useLayoutEffect:()=>{},Je=$e[" useInsertionEffect ".trim().toString()]||ve;function Qe({prop:s,defaultProp:r,onChange:n=()=>{},caller:u}){const[a,h,o]=es({defaultProp:r,onChange:n}),i=s!==void 0,f=i?s:a;{const l=d.useRef(s!==void 0);d.useEffect(()=>{const v=l.current;v!==i&&console.warn(`${u} is changing from ${v?"controlled":"uncontrolled"} to ${i?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),l.current=i},[i,u])}const w=d.useCallback(l=>{var v;if(i){const b=ss(l)?l(s):l;b!==s&&((v=o.current)==null||v.call(o,b))}else h(l)},[i,s,h,o]);return[f,w]}function es({defaultProp:s,onChange:r}){const[n,u]=d.useState(s),a=d.useRef(n),h=d.useRef(r);return Je(()=>{h.current=r},[r]),d.useEffect(()=>{var o;a.current!==n&&((o=h.current)==null||o.call(h,n),a.current=n)},[n,a]),[n,u,h]}function ss(s){return typeof s=="function"}function ts(s){const r=d.useRef({value:s,previous:s});return d.useMemo(()=>(r.current.value!==s&&(r.current.previous=r.current.value,r.current.value=s),r.current.previous),[s])}function rs(s){const[r,n]=d.useState(void 0);return ve(()=>{if(s){n({width:s.offsetWidth,height:s.offsetHeight});const u=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const h=a[0];let o,i;if("borderBoxSize"in h){const f=h.borderBoxSize,w=Array.isArray(f)?f[0]:f;o=w.inlineSize,i=w.blockSize}else o=s.offsetWidth,i=s.offsetHeight;n({width:o,height:i})});return u.observe(s,{box:"border-box"}),()=>u.unobserve(s)}else n(void 0)},[s]),r}function as(s){const r=ns(s),n=d.forwardRef((u,a)=>{const{children:h,...o}=u,i=d.Children.toArray(h),f=i.find(cs);if(f){const w=f.props.children,l=i.map(v=>v===f?d.Children.count(w)>1?d.Children.only(null):d.isValidElement(w)?w.props.children:null:v);return e.jsx(r,{...o,ref:a,children:d.isValidElement(w)?d.cloneElement(w,void 0,l):null})}return e.jsx(r,{...o,ref:a,children:h})});return n.displayName=`${s}.Slot`,n}function ns(s){const r=d.forwardRef((n,u)=>{const{children:a,...h}=n;if(d.isValidElement(a)){const o=ls(a),i=os(h,a.props);return a.type!==d.Fragment&&(i.ref=u?je(u,o):o),d.cloneElement(a,i)}return d.Children.count(a)>1?d.Children.only(null):null});return r.displayName=`${s}.SlotClone`,r}var is=Symbol("radix.slottable");function cs(s){return d.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===is}function os(s,r){const n={...r};for(const u in r){const a=s[u],h=r[u];/^on[A-Z]/.test(u)?a&&h?n[u]=(...i)=>{const f=h(...i);return a(...i),f}:a&&(n[u]=a):u==="style"?n[u]={...a,...h}:u==="className"&&(n[u]=[a,h].filter(Boolean).join(" "))}return{...s,...n}}function ls(s){var u,a;let r=(u=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:u.get,n=r&&"isReactWarning"in r&&r.isReactWarning;return n?s.ref:(r=(a=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:a.get,n=r&&"isReactWarning"in r&&r.isReactWarning,n?s.props.ref:s.props.ref||s.ref)}var ds=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],ge=ds.reduce((s,r)=>{const n=as(`Primitive.${r}`),u=d.forwardRef((a,h)=>{const{asChild:o,...i}=a,f=o?n:r;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(f,{...i,ref:h})});return u.displayName=`Primitive.${r}`,{...s,[r]:u}},{}),Z="Switch",[us,_s]=Ze(Z),[hs,ps]=us(Z),ye=d.forwardRef((s,r)=>{const{__scopeSwitch:n,name:u,checked:a,defaultChecked:h,required:o,disabled:i,value:f="on",onCheckedChange:w,form:l,...v}=s,[b,k]=d.useState(null),g=we(r,B=>k(B)),N=d.useRef(!1),R=b?l||!!b.closest("form"):!0,[E,T]=Qe({prop:a,defaultProp:h??!1,onChange:w,caller:Z});return e.jsxs(hs,{scope:n,checked:E,disabled:i,children:[e.jsx(ge.button,{type:"button",role:"switch","aria-checked":E,"aria-required":o,"data-state":Ce(E),"data-disabled":i?"":void 0,disabled:i,value:f,...v,ref:g,onClick:Xe(s.onClick,B=>{T(q=>!q),R&&(N.current=B.isPropagationStopped(),N.current||B.stopPropagation())})}),R&&e.jsx(_e,{control:b,bubbles:!N.current,name:u,value:f,checked:E,required:o,disabled:i,form:l,style:{transform:"translateX(-100%)"}})]})});ye.displayName=Z;var Se="SwitchThumb",be=d.forwardRef((s,r)=>{const{__scopeSwitch:n,...u}=s,a=ps(Se,n);return e.jsx(ge.span,{"data-state":Ce(a.checked),"data-disabled":a.disabled?"":void 0,...u,ref:r})});be.displayName=Se;var fs="SwitchBubbleInput",_e=d.forwardRef(({__scopeSwitch:s,control:r,checked:n,bubbles:u=!0,...a},h)=>{const o=d.useRef(null),i=we(o,h),f=ts(n),w=rs(r);return d.useEffect(()=>{const l=o.current;if(!l)return;const v=window.HTMLInputElement.prototype,k=Object.getOwnPropertyDescriptor(v,"checked").set;if(f!==n&&k){const g=new Event("click",{bubbles:u});k.call(l,n),l.dispatchEvent(g)}},[f,n,u]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...a,tabIndex:-1,ref:i,style:{...a.style,...w,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});_e.displayName=fs;function Ce(s){return s?"checked":"unchecked"}var Ne=ye,ms=be;const ke=De.forwardRef(({className:s,...r},n)=>e.jsx(Ne,{className:oe("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...r,ref:n,children:e.jsx(ms,{className:oe("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));ke.displayName=Ne.displayName;const Cs=()=>{const{toast:s}=Le(),{session:r}=Oe(),[n,u]=d.useState("users"),[a,h]=d.useState({users:[],deposits:[],withdrawals:[],kyc:[],tradeSettings:[]}),[o,i]=d.useState(!1),[f,w]=d.useState(null),[l,v]=d.useState(null),[b,k]=d.useState([]),[g,N]=d.useState(null),[R,E]=d.useState(""),T=d.useCallback(async()=>{if(r){i(!0);try{const{data:t,error:p}=await _.from("profiles").select("*");if(p)throw new Error(`Users Fetch: ${p.message}`);const c=t||[],j=new Map(c.map(H=>[H.id,H])),{data:y,error:S}=await _.from("deposits").select("*");if(S)throw new Error(`Deposits Fetch: ${S.message}`);const{data:P,error:W}=await _.from("withdrawals").select("*");if(W)throw new Error(`Withdrawals Fetch: ${W.message}`);const{data:V,error:ne}=await _.from("profiles").select("*").in("kyc_status",["pending","approved","rejected"]);if(ne)throw new Error(`KYC Fetch: ${ne.message}`);const{data:ze,error:Q}=await _.from("trade_settings").select("*").order("duration");if(Q&&Q.code!=="42P01")throw new Error(`Settings Fetch: ${Q.message}`);const ie=H=>H.map(ce=>({...ce,users:j.get(ce.user_id)}));h({users:c,deposits:ie(y||[]),withdrawals:ie(P||[]),kyc:V||[],tradeSettings:ze||[]})}catch(t){console.error(t),s({variant:"destructive",title:"Failed to fetch data",description:t.message})}i(!1)}},[s,r]);d.useEffect(()=>{r&&T()},[T,r]);const B=async(t,p,c)=>{const j=`${c}_${t==="deposits"?"deposit":"withdrawal"}`,y=t==="deposits"?"p_deposit_id":"p_withdrawal_id",{data:S,error:P}=await _.rpc(j,{[y]:p,p_admin_id:r.user.id});if(P)throw P;if(S&&!S.success)throw new Error(S.error);return S},q=async(t,p,c)=>{const{data:j}=await _.from("user_assets").select("*").eq("user_id",t).eq("symbol",p).maybeSingle();if(j){const{error:y}=await _.from("user_assets").update({amount:parseFloat(j.amount)+parseFloat(c)}).eq("id",j.id);if(y)throw y}else{const{error:y}=await _.from("user_assets").insert({user_id:t,symbol:p,amount:parseFloat(c)});if(y)throw y}},U=async(t,p,c,j={})=>{if(r){i(!0);try{if(t==="profiles"){const{error:S}=await _.from(t).update({kyc_status:c}).eq("id",p);if(S)throw S;s({title:"Success",description:`Status updated to ${c}`}),await T(),i(!1);return}if(t==="deposits"||t==="withdrawals"){const S=c==="approved"?"approve":"reject";try{await B(t,p,S),s({title:"Success",description:`Status updated to ${c}`}),await T(),i(!1);return}catch(P){if((P==null?void 0:P.code)==="PGRST202"){let W={status:c,reviewed_by:r.user.id,reviewed_at:new Date().toISOString()};const{error:V}=await _.from(t).update(W).eq("id",p);if(V)throw V;t==="deposits"&&c==="approved"&&j.userId?await q(j.userId,j.currency,j.amount):t==="withdrawals"&&c==="rejected"&&j.userId&&await q(j.userId,j.currency,j.amount),s({title:"Success",description:`Status updated to ${c}`}),await T(),i(!1);return}throw P}}const{error:y}=await _.from(t).update({status:c}).eq("id",p);if(y)throw y;s({title:"Success",description:`Status updated to ${c}`}),await T()}catch(y){s({variant:"destructive",title:"Update failed",description:y.message})}i(!1)}},G=async t=>{v(t),i(!0);const{data:p,error:c}=await _.from("user_assets").select("*").eq("user_id",t.id);c?(s({variant:"destructive",title:"Failed to fetch balances",description:c.message}),k([])):k(p),i(!1)},Ee=async(t,p)=>{const{error:c}=await _.from("user_assets").update({amount:p}).eq("id",t);c?s({variant:"destructive",title:"Update failed",description:c.message}):(s({title:"Success",description:"Balance updated"}),G(l))},Te=async()=>{if(!l||!R.trim())return;const t=R.trim().toUpperCase(),{error:p}=await _.from("user_assets").insert({user_id:l.id,symbol:t,amount:0});p?s({variant:"destructive",title:"Add failed",description:p.message}):(s({title:"Success",description:`${t} balance added`}),E(""),G(l))},Re=async()=>{if(!g)return;i(!0);const{id:t,...p}=g,{error:c}=await _.from("trade_settings").update(p).eq("id",t);c?s({variant:"destructive",title:"Update failed",description:c.message}):(s({title:"Success",description:"Trade setting updated"}),N(null),await T()),i(!1)},J=async(t,p)=>{i(!0);const{data:c,error:j}=await _.from("profiles").update({trade_override_status:p}).eq("id",t).select().single();j?s({variant:"destructive",title:"Override failed",description:j.message}):(s({title:"Success",description:`Trade override for user set to: ${p||"OFF"}`}),v(c),h(y=>({...y,users:y.users.map(S=>S.id===t?c:S)}))),i(!1)},Pe=async(t,p)=>{i(!0);const{data:c,error:j}=await _.from("profiles").update({is_admin:!p}).eq("id",t).select().single();j?s({variant:"destructive",title:"Update failed",description:j.message}):(s({title:"Success",description:"User admin status updated"}),v(c),h(y=>({...y,users:y.users.map(S=>S.id===t?c:S)}))),i(!1)},D=t=>{switch(t==null?void 0:t.toLowerCase()){case"approved":case"win":case"completed":return e.jsx(A,{variant:"success",className:"bg-green-500",children:t});case"pending":return e.jsx(A,{variant:"secondary",children:t});case"rejected":case"loss":return e.jsx(A,{variant:"destructive",children:t});default:return e.jsx(A,{children:t||"N/A"})}},Ae=()=>e.jsxs(K,{children:[e.jsx(Y,{children:e.jsxs(F,{children:[e.jsx(m,{children:"Name"}),e.jsx(m,{children:"Email"}),e.jsx(m,{children:"Role"}),e.jsx(m,{children:"KYC"}),e.jsx(m,{children:"Trade Override"}),e.jsx(m,{children:"Joined"}),e.jsx(m,{children:"Actions"})]})}),e.jsx(X,{children:a.users.map(t=>e.jsxs(F,{children:[e.jsxs(x,{children:[t.first_name||"N/A"," ",t.last_name||""]}),e.jsx(x,{children:t.email}),e.jsx(x,{children:t.is_admin?e.jsx(A,{className:"bg-purple-600",children:"Admin"}):e.jsx(A,{variant:"outline",children:"User"})}),e.jsx(x,{children:D(t.kyc_status)}),e.jsx(x,{children:t.trade_override_status?D(t.trade_override_status):e.jsx(A,{variant:"outline",children:"Off"})}),e.jsx(x,{children:new Date(t.created_at).toLocaleDateString()}),e.jsx(x,{children:e.jsx(C,{variant:"ghost",size:"icon",onClick:()=>G(t),children:e.jsx(fe,{className:"h-4 w-4"})})})]},t.id))})]}),ae=(t,p)=>e.jsxs(K,{children:[e.jsx(Y,{children:e.jsxs(F,{children:[e.jsx(m,{children:"User"}),e.jsx(m,{children:"Email"}),e.jsx(m,{children:"Amount"}),e.jsx(m,{children:"Status"}),p==="deposits"&&e.jsx(m,{children:"Proof"}),p==="withdrawals"&&e.jsx(m,{children:"Address"}),e.jsx(m,{children:"Date"}),e.jsx(m,{children:"Actions"})]})}),e.jsx(X,{children:t.map(c=>{var j,y,S;return e.jsxs(F,{children:[e.jsxs(x,{children:[((j=c.users)==null?void 0:j.first_name)||"N/A"," ",((y=c.users)==null?void 0:y.last_name)||""]}),e.jsx(x,{children:(S=c.users)==null?void 0:S.email}),e.jsxs(x,{children:[c.amount," ",c.currency]}),e.jsx(x,{children:D(c.status)}),p==="deposits"&&e.jsx(x,{children:c.proof_url&&e.jsx(M,{children:e.jsx(pe,{asChild:!0,children:e.jsx(C,{variant:"outline",size:"icon",onClick:()=>w(c.proof_url),children:e.jsx(me,{className:"h-4 w-4"})})})})}),p==="withdrawals"&&e.jsx(x,{className:"truncate max-w-[150px]",children:c.wallet_address}),e.jsx(x,{children:new Date(c.created_at).toLocaleString()}),e.jsx(x,{className:"space-x-2",children:c.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(C,{size:"icon",variant:"ghost",className:"text-green-500",onClick:()=>U(p,c.id,"approved",{userId:c.user_id,amount:c.amount,currency:c.currency}),children:e.jsx(ue,{className:"h-4 w-4"})}),e.jsx(C,{size:"icon",variant:"ghost",className:"text-red-500",onClick:()=>U(p,c.id,"rejected",{userId:c.user_id,amount:c.amount,currency:c.currency}),children:e.jsx(he,{className:"h-4 w-4"})})]})})]},c.id)})})]}),Fe=()=>e.jsxs(K,{children:[e.jsx(Y,{children:e.jsxs(F,{children:[e.jsx(m,{children:"Name"}),e.jsx(m,{children:"Email"}),e.jsx(m,{children:"Country"}),e.jsx(m,{children:"Status"}),e.jsx(m,{children:"Document"}),e.jsx(m,{children:"Actions"})]})}),e.jsx(X,{children:a.kyc.map(t=>e.jsxs(F,{children:[e.jsxs(x,{children:[t.first_name," ",t.last_name]}),e.jsx(x,{children:t.email||"N/A"}),e.jsx(x,{children:t.country||"N/A"}),e.jsx(x,{children:D(t.kyc_status)}),e.jsx(x,{children:t.id_document_url&&e.jsx(M,{children:e.jsx(pe,{asChild:!0,children:e.jsx(C,{variant:"outline",size:"icon",onClick:()=>w(t.id_document_url),children:e.jsx(me,{className:"h-4 w-4"})})})})}),e.jsx(x,{className:"space-x-2",children:t.kyc_status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(C,{size:"icon",variant:"ghost",className:"text-green-500",onClick:()=>U("profiles",t.id,"approved",{kyc:!0}),children:e.jsx(ue,{className:"h-4 w-4"})}),e.jsx(C,{size:"icon",variant:"ghost",className:"text-red-500",onClick:()=>U("profiles",t.id,"rejected",{kyc:!0}),children:e.jsx(he,{className:"h-4 w-4"})})]})})]},t.id))})]}),Be=()=>e.jsxs(K,{children:[e.jsx(Y,{children:e.jsxs(F,{children:[e.jsx(m,{children:"Duration (s)"}),e.jsx(m,{children:"Win Rate (%)"}),e.jsx(m,{children:"Loss Rate (%)"}),e.jsx(m,{children:"Min Capital"}),e.jsx(m,{children:"Actions"})]})}),e.jsx(X,{children:a.tradeSettings.map(t=>e.jsxs(F,{children:[e.jsx(x,{children:t.duration}),e.jsx(x,{children:(t.win_rate*100).toFixed(2)}),e.jsx(x,{children:(t.loss_rate*100).toFixed(2)}),e.jsx(x,{children:t.min_capital}),e.jsx(x,{children:e.jsx(C,{size:"icon",variant:"ghost",onClick:()=>N(t),children:e.jsx(fe,{className:"h-4 w-4"})})})]},t.id))})]});return e.jsxs(e.Fragment,{children:[e.jsx(Me,{children:e.jsx("title",{children:"Admin Panel - MetaTradeX"})}),e.jsxs("div",{className:"container mx-auto p-4 sm:p-6 lg:p-8",children:[e.jsxs(le.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Admin Panel"}),e.jsx(C,{onClick:T,disabled:o,variant:"outline",size:"icon",children:e.jsx(He,{className:`h-4 w-4 ${o?"animate-spin":""}`})})]}),e.jsxs(Ie,{value:n,onValueChange:u,className:"w-full",children:[e.jsxs(qe,{className:"grid w-full grid-cols-2 sm:grid-cols-3 md:grid-cols-5 mb-4",children:[e.jsxs(L,{value:"users",children:[e.jsx(Ye,{className:"w-4 h-4 mr-2"}),"Users"]}),e.jsxs(L,{value:"deposits",children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),"Deposits"]}),e.jsxs(L,{value:"withdrawals",children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),"Withdrawals"]}),e.jsxs(L,{value:"kyc",children:[e.jsx(We,{className:"w-4 h-4 mr-2"}),"KYC"]}),e.jsxs(L,{value:"settings",children:[e.jsx(Ke,{className:"w-4 h-4 mr-2"}),"Trading"]})]}),e.jsxs(le.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},transition:{duration:.3},className:"overflow-x-auto",children:[e.jsx(O,{value:"users",children:o?e.jsx("p",{children:"Loading..."}):Ae()}),e.jsx(O,{value:"deposits",children:o?e.jsx("p",{children:"Loading..."}):ae(a.deposits,"deposits")}),e.jsx(O,{value:"withdrawals",children:o?e.jsx("p",{children:"Loading..."}):ae(a.withdrawals,"withdrawals")}),e.jsx(O,{value:"kyc",children:o?e.jsx("p",{children:"Loading..."}):Fe()}),e.jsx(O,{value:"settings",children:o?e.jsx("p",{children:"Loading..."}):Be()})]},n)]})]}),e.jsx(M,{open:!!f,onOpenChange:()=>w(null),children:e.jsxs(ee,{className:"max-w-3xl",children:[e.jsx(se,{children:e.jsx(te,{children:"Document Viewer"})}),f&&e.jsx("img",{src:f,alt:"KYC or Deposit Proof",className:"max-w-full h-auto rounded-md"}),e.jsxs(re,{children:[e.jsx(C,{onClick:()=>window.open(f,"_blank"),children:"Download"}),e.jsx(C,{onClick:()=>w(null),children:"Close"})]})]})}),e.jsx(M,{open:!!l,onOpenChange:()=>v(null),children:e.jsxs(ee,{className:"max-w-2xl",children:[e.jsxs(se,{children:[e.jsxs(te,{children:["Edit User: ",l==null?void 0:l.first_name," ",l==null?void 0:l.last_name]}),e.jsx(Ue,{children:"Manage user balances and trade outcomes."})]}),e.jsxs("div",{className:"py-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-md bg-muted/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"h-4 w-4 text-purple-600"}),e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(z,{className:"text-base",children:"Admin Status"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Grant full administrative access to this user."})]})]}),e.jsx(ke,{checked:l==null?void 0:l.is_admin,onCheckedChange:()=>Pe(l.id,l.is_admin),disabled:o})]}),e.jsx("h3",{className:"font-semibold",children:"Balances"}),o?e.jsx("p",{children:"Loading balances..."}):b.map(t=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-20",children:t.symbol}),e.jsx(I,{type:"number",defaultValue:t.amount,onBlur:p=>Ee(t.id,p.target.value)})]},t.id)),e.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[e.jsx(I,{placeholder:"Symbol (e.g. BTC)",value:R,onChange:t=>E(t.target.value),className:"w-40"}),e.jsx(C,{variant:"outline",size:"sm",onClick:Te,disabled:!R.trim(),children:"Add Balance"})]}),e.jsx("h3",{className:"font-semibold pt-4",children:"Trade Control"}),e.jsxs("div",{className:"p-3 rounded-md border bg-background/50 space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(z,{children:"Current Status:"}),l!=null&&l.trade_override_status?D(l.trade_override_status):e.jsx(A,{variant:"outline",children:"OFF"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2",children:[e.jsx(C,{variant:"success",className:"bg-green-500",onClick:()=>J(l.id,"win"),disabled:o||(l==null?void 0:l.trade_override_status)==="win",children:"Switch Win ON"}),e.jsx(C,{variant:"destructive",onClick:()=>J(l.id,"loss"),disabled:o||(l==null?void 0:l.trade_override_status)==="loss",children:"Switch Loss ON"}),e.jsx(C,{variant:"outline",onClick:()=>J(l.id,null),disabled:o||!(l!=null&&l.trade_override_status),children:"Switch OFF"})]})]})]}),e.jsx(re,{children:e.jsx(C,{onClick:()=>v(null),children:"Close"})})]})}),e.jsx(M,{open:!!g,onOpenChange:()=>N(null),children:e.jsxs(ee,{children:[e.jsx(se,{children:e.jsxs(te,{children:["Edit Setting for ",g==null?void 0:g.duration,"s"]})}),g&&e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(z,{htmlFor:"win_rate",className:"text-right",children:"Win Rate (%)"}),e.jsx(I,{id:"win_rate",type:"number",value:g.win_rate*100,onChange:t=>N({...g,win_rate:parseFloat(t.target.value)/100}),className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(z,{htmlFor:"loss_rate",className:"text-right",children:"Loss Rate (%)"}),e.jsx(I,{id:"loss_rate",type:"number",value:g.loss_rate*100,onChange:t=>N({...g,loss_rate:parseFloat(t.target.value)/100}),className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(z,{htmlFor:"min_capital",className:"text-right",children:"Min Capital"}),e.jsx(I,{id:"min_capital",type:"number",value:g.min_capital,onChange:t=>N({...g,min_capital:parseFloat(t.target.value)}),className:"col-span-3"})]})]}),e.jsx(re,{children:e.jsx(C,{onClick:Re,disabled:o,children:o?"Saving...":"Save Changes"})})]})})]})};export{Cs as default};
